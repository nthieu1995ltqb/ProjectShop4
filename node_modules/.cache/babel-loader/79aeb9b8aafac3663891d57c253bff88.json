{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pc\\\\Desktop\\\\abc\\\\FE08-TrungHieu-XuanQuy\\\\src\\\\pages\\\\Checkout\\\\Checkout.js\";\nimport React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport CheckoutItem from './CheckoutItem';\nimport { connect } from 'react-redux';\nimport { actDeleteCheckOut } from '../../actions/actions';\nimport callApi from '../../utils/apiCaller';\n\nclass Checkout extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = e => {\n      this.setState({\n        [e.target.id]: e.target.value\n      });\n    };\n\n    this.handleSubmit = e => {\n      e.preventDefault();\n      var isValid = true;\n      var _this$state = this.state,\n          name = _this$state.name,\n          address = _this$state.address,\n          phone = _this$state.phone,\n          email = _this$state.email; //console.log(name, address, phone)\n\n      var _this$props = this.props,\n          checkOutProduct = _this$props.checkOutProduct,\n          history = _this$props.history;\n      var time = new Date(); //console.log(email)\n      //check name\n\n      if (name === \"\") {\n        //console.log(\"err\")\n        isValid = false;\n        this.showValidationErr(\"name\", \"Bạn phải nhập Họ tên\");\n      } else {\n        this.showValidationErr(\"name\", \"\");\n      } //check phone_number\n\n\n      if (phone === \"\") {\n        isValid = false;\n        this.showValidationErr(\"phone\", \"Bạn phải nhập số điện thoại\");\n      } else if (isNaN(phone)) {\n        isValid = false;\n        this.showValidationErr(\"phone\", \"Số điện thoại là số. Không phải là kí tự\");\n      } else {\n        this.showValidationErr(\"phone\", \"\");\n      } //check address\n\n\n      if (address === \"\") {\n        isValid = false;\n        this.showValidationErr(\"address\", \"Bạn phải nhập địa chỉ\");\n      } else {\n        this.showValidationErr(\"address\", \"\");\n      } //check dieu kien\n\n\n      if (isValid) {\n        callApi('checkout', 'POST', {\n          name: name,\n          address: address,\n          email: email,\n          phone: phone,\n          time: time,\n          checkOutProduct: checkOutProduct,\n          total: this.showTotalAmount(checkOutProduct),\n          status: true\n        }).then(res => {\n          //localStorage.removeItem('CART');\n          alert(\"Bạn đã thanh toán thành công. Quay lại trang chủ để tiếp tục mua sắm\");\n          history.push(\"/\");\n          this.onCheckOut();\n        });\n      }\n    };\n\n    this.showCartItem = item => {\n      var result = null;\n\n      if (item.length > 0) {\n        result = item.map((item, index) => {\n          return React.createElement(CheckoutItem, {\n            key: index,\n            item: item,\n            index: index,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 235\n            },\n            __self: this\n          });\n        });\n      }\n\n      return result;\n    };\n\n    this.showTotalAmount = cartProduct => {\n      var total = 0;\n\n      if (cartProduct.length > 0) {\n        for (var i = 0; i < cartProduct.length; i++) {\n          total += cartProduct[i].product.price * cartProduct[i].quantity;\n        }\n      } // console.log(total)\n\n\n      return total;\n    };\n\n    this.onCheckOut = () => {\n      //   console.log(product);\n      var onDeleteCheckOut = this.props.onDeleteCheckOut;\n      onDeleteCheckOut();\n    };\n\n    this.state = {\n      name: '',\n      address: '',\n      phone: '',\n      email: '',\n      errors: []\n    };\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  showValidationErr(elm, msg) {\n    this.setState(prevState => ({\n      errors: [...prevState.errors, {\n        elm,\n        msg\n      }]\n    }));\n  }\n\n  componentDidMount() {\n    var test = 'TOKEN';\n    let history = this.props.history; //console.log(history)\n    // var a = sessionStorage.key('')\n\n    if (test in sessionStorage) {\n      var email = sessionStorage.getItem('TOKEN');\n      email = email.replace(/\"/g, \"\");\n      this.setState({\n        email: email\n      });\n    } else {\n      //console.log(\"err\")\n      alert(\"Bạn chưa đăng nhập. Bạn cần phải đăng nhập mới được thanh toán\");\n      history.push(\"/login\");\n    }\n  }\n\n  render() {\n    var checkOutProduct = this.props.checkOutProduct; //console.log(checkOutProduct)\n\n    let phoneErr,\n        addressErr,\n        nameErr = null;\n\n    for (let err of this.state.errors) {\n      if (err.elm === \"phone\") {\n        phoneErr = err.msg;\n      }\n\n      if (err.elm === \"address\") {\n        addressErr = err.msg;\n      }\n\n      if (err.elm === \"name\") {\n        nameErr = err.msg;\n      }\n    }\n\n    return React.createElement(\"div\", {\n      id: \"cart_items\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"breadcrumbs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"ol\", {\n      className: \"breadcrumb\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, React.createElement(NavLink, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }, \"Trang Ch\\u1EE7\")), React.createElement(\"li\", {\n      className: \"active\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, \"Thanh to\\xE1n\"))), React.createElement(\"div\", {\n      className: \"row login\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-sm-7\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"table-responsive cart_info\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, React.createElement(\"table\", {\n      className: \"table table-condensed\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      className: \"cart_menu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      className: \"image\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, \"S\\u1EA3n Ph\\u1EA9m\"), React.createElement(\"td\", {\n      className: \"description\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }), React.createElement(\"td\", {\n      className: \"price\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"Gi\\xE1\"), React.createElement(\"td\", {\n      className: \"quantity\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, \"S\\u1ED1 L\\u01B0\\u1EE3ng\"), React.createElement(\"td\", {\n      className: \"total\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \"S\\u1ED1 Ti\\u1EC1n\"), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, this.showCartItem(checkOutProduct), React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }), React.createElement(\"td\", {\n      className: \"cart_total\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"cart_total_price\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, \"T\\u1ED5ng ti\\u1EC1n: $ \", this.showTotalAmount(checkOutProduct), \"  \"))))))), React.createElement(\"div\", {\n      className: \"col-sm-4 col-sm-offset-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, \"Dia chi giao hang\"), React.createElement(\"div\", {\n      className: \"checkout-name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, \"Ten: \", React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, \"abc\"))), React.createElement(\"div\", {\n      className: \"login-form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    }, \"Th\\xF4ng tin thanh to\\xE1n\"), React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      action: \"#\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      id: \"name\",\n      name: \"name\",\n      value: this.state.name,\n      placeholder: \"H\\u1ECD t\\xEAn\",\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }), React.createElement(\"small\", {\n      className: \"text-danger\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, \" \", nameErr ? nameErr : \"\", \" \"), React.createElement(\"input\", {\n      type: \"text\",\n      id: \"address\",\n      name: \"address\",\n      value: this.state.address,\n      placeholder: \"\\u0110\\u1ECBa Ch\\u1EC9\",\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }), React.createElement(\"small\", {\n      className: \"text-danger\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, \" \", addressErr ? addressErr : \"\", \" \"), React.createElement(\"input\", {\n      type: \"text\",\n      id: \"phone\",\n      name: \"phone\",\n      value: this.state.phone,\n      placeholder: \"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\",\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }), React.createElement(\"small\", {\n      className: \"text-danger\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, \" \", phoneErr ? phoneErr : \"\", \" \"), React.createElement(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-default\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, \"Thanh To\\xE1n \\u0110\\u01A1n H\\xE0ng\")))))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    checkOutProduct: state.cartProduct\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    onDeleteCheckOut: product => {\n      dispatch(actDeleteCheckOut(product));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Checkout);","map":{"version":3,"sources":["C:/Users/Pc/Desktop/abc/FE08-TrungHieu-XuanQuy/src/pages/Checkout/Checkout.js"],"names":["React","NavLink","CheckoutItem","connect","actDeleteCheckOut","callApi","Checkout","Component","constructor","props","handleChange","e","setState","target","id","value","handleSubmit","preventDefault","isValid","state","name","address","phone","email","checkOutProduct","history","time","Date","showValidationErr","isNaN","total","showTotalAmount","status","then","res","alert","push","onCheckOut","showCartItem","item","result","length","map","index","cartProduct","i","product","price","quantity","onDeleteCheckOut","errors","bind","elm","msg","prevState","componentDidMount","test","sessionStorage","getItem","replace","render","phoneErr","addressErr","nameErr","err","mapStateToProps","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {NavLink} from 'react-router-dom';\r\nimport CheckoutItem from './CheckoutItem';\r\nimport { connect } from 'react-redux';\r\nimport {actDeleteCheckOut} from '../../actions/actions'\r\nimport callApi from '../../utils/apiCaller';\r\n\r\nclass Checkout extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            name: '',\r\n            address:'',\r\n            phone:'',\r\n            email: '',\r\n            errors: []\r\n        }\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n        this.handleChange = this.handleChange.bind(this);\r\n    }\r\n\r\n    showValidationErr(elm, msg){\r\n        this.setState((prevState) => ({errors: [...prevState.errors, {elm, msg}] } ));\r\n    }\r\n\r\n    componentDidMount(){\r\n        var test = 'TOKEN';\r\n        let { history} = this.props;\r\n        //console.log(history)\r\n        // var a = sessionStorage.key('')\r\n\r\n        if (test in sessionStorage){\r\n            var email = sessionStorage.getItem('TOKEN');\r\n            email = email.replace(/\"/g, \"\");\r\n            this.setState({\r\n                email: email\r\n            })\r\n        } else{\r\n            \r\n            //console.log(\"err\")\r\n            alert(\"Bạn chưa đăng nhập. Bạn cần phải đăng nhập mới được thanh toán\")\r\n            history.push(\"/login\");\r\n\r\n        }\r\n\r\n    } \r\n\r\n    handleChange = (e) =>{\r\n        this.setState({\r\n            [e.target.id]: e.target.value\r\n        })\r\n    }\r\n    handleSubmit = (e) =>{\r\n        e.preventDefault();\r\n        var isValid = true;\r\n\r\n        var {name, address, phone, email} = this.state;\r\n        //console.log(name, address, phone)\r\n        var {checkOutProduct, history} = this.props;\r\n        \r\n        var time = new Date();\r\n        //console.log(email)\r\n        //check name\r\n        if (name === \"\"){\r\n            //console.log(\"err\")\r\n            isValid = false;\r\n            this.showValidationErr(\"name\", \"Bạn phải nhập Họ tên\")\r\n        } else {\r\n            this.showValidationErr(\"name\", \"\")\r\n        }\r\n        //check phone_number\r\n        if (phone === \"\"){\r\n            isValid = false;\r\n            this.showValidationErr(\"phone\", \"Bạn phải nhập số điện thoại\")\r\n        } else if (isNaN(phone)){\r\n            isValid = false;\r\n            this.showValidationErr(\"phone\", \"Số điện thoại là số. Không phải là kí tự\")\r\n        }\r\n         else {\r\n            this.showValidationErr(\"phone\", \"\")\r\n        }\r\n        //check address\r\n        if (address === \"\"){\r\n            isValid = false;\r\n            this.showValidationErr(\"address\", \"Bạn phải nhập địa chỉ\")\r\n        } else {\r\n            this.showValidationErr(\"address\", \"\")\r\n        }\r\n        //check dieu kien\r\n        if(isValid){\r\n            callApi('checkout', 'POST', {\r\n                name: name,\r\n                address: address,\r\n                email: email,\r\n                phone: phone,\r\n                time: time,\r\n                checkOutProduct: checkOutProduct,\r\n                total: this.showTotalAmount(checkOutProduct),\r\n                status: true\r\n    \r\n            }).then(res => {\r\n                \r\n                //localStorage.removeItem('CART');\r\n                alert(\"Bạn đã thanh toán thành công. Quay lại trang chủ để tiếp tục mua sắm\");\r\n                history.push(\"/\");\r\n                this.onCheckOut()\r\n                \r\n            }) \r\n        }\r\n        \r\n    }\r\n\r\n   \r\n\r\n    render(){\r\n \r\n        var {checkOutProduct} = this.props;\r\n        //console.log(checkOutProduct)\r\n        let phoneErr, addressErr, nameErr  = null;\r\n        for(let err of this.state.errors){\r\n            if(err.elm === \"phone\"){\r\n                phoneErr = err.msg\r\n            } \r\n            if (err.elm === \"address\"){\r\n                addressErr = err.msg\r\n            }\r\n            if (err.elm === \"name\"){\r\n                nameErr = err.msg\r\n            } \r\n\r\n        }\r\n\r\n        return(\r\n            <div id=\"cart_items\">\r\n                <div className=\"container\">\r\n                    <div className=\"breadcrumbs\">\r\n                        <ol className=\"breadcrumb\">\r\n                        <li><NavLink to=\"/\">Trang Chủ</NavLink></li>\r\n                        <li className=\"active\">Thanh toán</li>\r\n                        </ol>\r\n                    </div>\r\n                    <div className=\"row login\">\r\n                        <div className=\"col-sm-7\">\r\n                            <div className=\"table-responsive cart_info\">\r\n                                <table className=\"table table-condensed\">\r\n                                    <thead>\r\n                                        <tr className=\"cart_menu\">\r\n                                            <td className=\"image\">Sản Phẩm</td>\r\n                                            <td className=\"description\"></td>\r\n                                            <td className=\"price\">Giá</td>\r\n                                            <td className=\"quantity\">Số Lượng</td>\r\n                                            <td className=\"total\">Số Tiền</td>\r\n                                            <td></td>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {this.showCartItem(checkOutProduct)}\r\n                                        <tr>\r\n                                            <td></td>\r\n\r\n                                            <td className=\"cart_total\">\r\n                                                <p className=\"cart_total_price\">Tổng tiền: $ {this.showTotalAmount(checkOutProduct)}  </p>\r\n                                            </td>\r\n                                        </tr>\r\n    \r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n    \r\n                        <div className=\"col-sm-4 col-sm-offset-1\">\r\n                            <div>\r\n                                <h2>Dia chi giao hang</h2>\r\n                                <div className=\"checkout-name\">\r\n                                    Ten: <span>abc</span>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"login-form\">\r\n                                <h2>Thông tin thanh toán</h2>\r\n                                <form onSubmit={this.handleSubmit} action=\"#\">\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        id=\"name\"\r\n                                        name=\"name\"\r\n                                        value={this.state.name}\r\n                                        placeholder=\"Họ tên\"\r\n                                        onChange={this.handleChange}\r\n                                      \r\n                                    />\r\n                                    <small className=\"text-danger\"> {nameErr ? nameErr : \"\"} </small>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        id=\"address\"\r\n                                        name=\"address\"\r\n                                        value={this.state.address}\r\n                                        placeholder=\"Địa Chỉ\"\r\n                                        onChange={this.handleChange}\r\n                                  \r\n                                    />\r\n                                    <small className=\"text-danger\"> {addressErr ? addressErr : \"\"} </small>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        id=\"phone\"\r\n                                        name=\"phone\"\r\n                                        value={this.state.phone}\r\n                                        placeholder=\"Số điện thoại\"\r\n                                        onChange={this.handleChange}\r\n                                      \r\n                                    />\r\n                                    <small className=\"text-danger\"> {phoneErr ? phoneErr : \"\"} </small>\r\n                                    <button \r\n                                        type=\"submit\"\r\n                                        className=\"btn btn-default\"\r\n        \r\n                                        >Thanh Toán Đơn Hàng</button>\r\n                                </form>\r\n                            </div>\r\n                        </div>\r\n                        \r\n                        \r\n                    </div>\r\n                    \r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n    showCartItem = (item) =>{\r\n        \r\n        var result = null\r\n        if(item.length > 0){\r\n            result = item.map((item, index)=>{\r\n                return(\r\n                    <CheckoutItem \r\n                        key={index}\r\n                        item={item}\r\n                        index={index}\r\n                        \r\n                    />\r\n                )\r\n            })\r\n        }\r\n        return result;\r\n    }\r\n\r\n    showTotalAmount = (cartProduct) =>{\r\n        var total = 0;\r\n        if (cartProduct.length >0){\r\n            for (var i = 0; i< cartProduct.length; i++){\r\n                total += cartProduct[i].product.price * cartProduct[i].quantity;\r\n            }\r\n        }\r\n        // console.log(total)\r\n        return total;\r\n    }\r\n\r\n    onCheckOut = () => {\r\n        //   console.log(product);\r\n            var {onDeleteCheckOut} = this.props;\r\n            onDeleteCheckOut();\r\n            \r\n        }\r\n\r\n\r\n}\r\n\r\nconst mapStateToProps = state =>{\r\n    return{\r\n        checkOutProduct: state.cartProduct\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        onDeleteCheckOut: (product) => {\r\n            dispatch(actDeleteCheckOut(product));\r\n        }\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps) (Checkout);"]},"metadata":{},"sourceType":"module"}